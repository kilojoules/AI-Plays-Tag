# Trajectory Rendering Guide

This workflow converts a captured episode (`trajectory.jsonl`) into a replay video.

## Prerequisites
- Godot 4 binary available (set `GODOT_BIN` if not found automatically).
- A trajectory file, typically generated by running headless training with `AI_LOG_TRAJECTORIES=1`.

## Steps
1. Point the script at the trajectory (defaults to the most recent file in Godot's `app_userdata`):
   ```bash
   GODOT_BIN=/path/to/Godot \
   AI_REPLAY_PATH="$HOME/Library/Application Support/Godot/app_userdata/AI Tag Game/trajectories/ep_00042.jsonl" \
   ./scripts/render_trajectory.sh high
   ```
   - Use `low` for faster preview renders.
2. The script launches `Replay.tscn` with recording enabled, then calls `scripts/encode_frames.sh` to produce an MP4 in the project root.
3. Raw frames remain in `app_userdata/AI Tag Game/frames` until deleted. The encoder overwrites any existing `out.mp4` unless you move/rename it.

## Output Checklist
- `frames/frame_XXXXX.png` sequence for each captured frame (60 FPS by default).
- `learn_progress-<timestamp>.mp4` or `out.mp4` assembled via FFmpeg.
- Optional debug bundle: use `scripts/collect_debug_artifacts.sh` to save the MP4, trajectory, and metadata together.

## Tips
- For reproducible replays, pin the same commit and policy weights used during the run.
- Set `AI_RENDER_QUALITY` (`high`/`low`) and `AI_RECORD_FPS` before launching to tweak visual fidelity and cadence.
